* Packages
Run all as root.
** Apt
#+BEGIN_SRC sh :dir "/sudo::" :results output verbatim
apt update
apt upgrade
#+END_SRC

#+RESULTS:

#+NAME: apt-repos
| name | comment |
|------+---------|
|      |         |


#+NAME: apt-sources
| name             | comment                           |
|------------------+-----------------------------------|
| curl             |                                   |
| wget             |                                   |
| xclip            |                                   |
| pass             |                                   |
| openvpn          |                                   |
| calibre          |                                   |
| htop             |                                   |
| racket           |                                   |
| transmission     |                                   |
| bitwise          | bitwise cli calculator            |
| emacs26          | requires ubuntu 19+               |
| cmake            | requires ubuntu 19+, for libvterm |
| libtool-bin      | for libvterm                      |
| fonts-firacode   | for doom emacs                    |
| zlib1g-dev       | for installing python w/ pyenv    |
| build-essential  | python + pyenv                    |
| libssl-dev       | python + pyenv                    |
| libbz2-dev       | python + pyenv                    |
| libreadline-dev  | python + pyenv                    |
| libsqlite3-dev   | python + pyenv                    |
| llvm             | python + pyenv                    |
| libncurses5-dev  | python + pyenv                    |
| libncursesw5-dev | python + pyenv                    |
| xz-utils         | python + pyenv                    |
| tk-dev           | python + pyenv                    |
| libffi-dev       | python + pyenv                    |
| liblzma-dev      | python + pyenv                    |
| python-openssl   | python + pyenv                    |

#+BEGIN_SRC elisp :var table=apt-repos
(s-join " " (-map 'car table))
#+END_SRC

#+NAME: apt-repo-string
#+RESULTS:
: ppa:ramon-fried/bitwise

#+BEGIN_SRC elisp :var table=apt-sources
(s-join " " (-map 'car table))
#+END_SRC

#+NAME: apt-source-string
#+RESULTS:
: curl wget xclip pass openvpn calibre htop racket transmission bitwise emacs26 cmake libtool-bin fonts-firacode zlib1g-dev build-essential libssl-dev libbz2-dev libreadline-dev libsqlite3-dev llvm libncurses5-dev libncursesw5-dev xz-utils tk-dev libffi-dev liblzma-dev python-openssl


#+BEGIN_SRC sh :var sources=apt-repo-string :dir "/sudo::" :results output verbatim
yes | add-apt-repository --remove $sources
apt update
#+END_SRC

#+RESULTS:
#+begin_example
 Bitwise PPA
 More info: https://launchpad.net/~ramon-fried/+archive/ubuntu/bitwise
[33m0% [Working][0m            Hit:1 http://security.ubuntu.com/ubuntu eoan-security InRelease
[33m0% [Waiting for headers] [Connecting to ppa.launchpad.net (91.189.95.83)][0m                                                                         Hit:2 http://us.archive.ubuntu.com/ubuntu eoan InRelease
[33m                                                                         0% [Waiting for headers] [Waiting for headers][0m                                              Hit:3 http://us.archive.ubuntu.com/ubuntu eoan-updates InRelease
[33m                                              0% [Waiting for headers][0m[33m0% [Waiting for headers] [Waiting for headers][0m                                              Hit:4 http://us.archive.ubuntu.com/ubuntu eoan-backports InRelease
[33m                                              0% [Waiting for headers][0m                        Hit:5 http://ppa.launchpad.net/kelleyk/emacs/ubuntu eoan InRelease
[33m                        0% [Working][0m[33m0% [Working][0m[33m0% [Working][0m[33m0% [Working][0m[33m20% [Working][0m             Reading package lists... 0%Reading package lists... 0%Reading package lists... 0%Reading package lists... 3%Reading package lists... 3%Reading package lists... 7%Reading package lists... 7%Reading package lists... 9%Reading package lists... 9%Reading package lists... 9%Reading package lists... 9%Reading package lists... 9%Reading package lists... 9%Reading package lists... 9%Reading package lists... 9%Reading package lists... 41%Reading package lists... 41%Reading package lists... 72%Reading package lists... 72%Reading package lists... 89%Reading package lists... 89%Reading package lists... 89%Reading package lists... 89%Reading package lists... 89%Reading package lists... 89%Reading package lists... 90%Reading package lists... 90%Reading package lists... 91%Reading package lists... 91%Reading package lists... 92%Reading package lists... 92%Reading package lists... 92%Reading package lists... 92%Reading package lists... 92%Reading package lists... 92%Reading package lists... 92%Reading package lists... 92%Reading package lists... 93%Reading package lists... 93%Reading package lists... 94%Reading package lists... 94%Reading package lists... 94%Reading package lists... 94%Reading package lists... 94%Reading package lists... 94%Reading package lists... 94%Reading package lists... 94%Reading package lists... 94%Reading package lists... 94%Reading package lists... 94%Reading package lists... 94%Reading package lists... 94%Reading package lists... 94%Reading package lists... 94%Reading package lists... 94%Reading package lists... 95%Reading package lists... 95%Reading package lists... 96%Reading package lists... 96%Reading package lists... 96%Reading package lists... 96%Reading package lists... 96%Reading package lists... 96%Reading package lists... 96%Reading package lists... 96%Reading package lists... 97%Reading package lists... 97%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... 98%Reading package lists... Done
Building dependency tree... 0%Building dependency tree... 0%Building dependency tree... 0%Building dependency tree... 50%Building dependency tree... 50%Building dependency tree       
Reading state information... 0%Reading state information... 0%Reading state information... Done
8 packages can be upgraded. Run 'apt list --upgradable' to see them.
#+end_example

#+BEGIN_SRC sh :var sources=apt-source-string :dir "/sudo::" :results output verbatim
yes | apt install $sources
#+END_SRC

#+RESULTS:

*** Antibody
#+BEGIN_SRC shell :dir "/sudo::"
curl -sfL git.io/antibody | sh -s - -b /usr/local/bin
#+END_SRC
#+RESULTS:

* Shell
#+BEGIN_SRC shell
# NOTE You probably want to generate an SSH key for bitbucket for this machine.
git clone https://bitbucket.org/txru/passwords.git ~/.password-store
# NOTE You should fetch your GPG key yourself.
git clone https://bitbucket.org/txru/dotfiles.git ~/.dotfiles
python3 ~/.dotfiles/home/copier.py
#+END_SRC
* Emacs
#+BEGIN_SRC shell
git clone https://github.com/hlissner/doom-emacs ~/.emacs.d
yes | ~/.emacs.d/bin/doom install

mkdir -p ~/.emacs.d/.local/straight/repos/emacs-libvterm/build
cd ~/.emacs.d/.local/straight/repos/emacs-libvterm/build
cmake ..
make
cd -
#+END_SRC
* Rust
#+BEGIN_SRC shell
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
source ~/.cargo/env

rustup toolchain add nightly
rustup component add rust-src
rustup component add clippy

cargo +nightly install racer
cargo install ripgrep
#+END_SRC
* Python
#+BEGIN_SRC shell
git clone https://github.com/pyenv/pyenv.git ~/.pyenv
git clone https://github.com/momo-lab/xxenv-latest.git "$(pyenv root)"/plugins/xxenv-latest
pyenv latest install
pyenv global $(pyenv versions | tail -n 1)
pip install black pyls ipython poetry virtualenv # requests beautifulsoup4
mkdir -p $HOME/.zfunc
poetry completions zsh > ~/.zfunc/_poetry
#+END_SRC
* Node
#+BEGIN_SRC shell
source $HOME/.zshrc
curl -fsSL https://raw.githubusercontent.com/nodenv/nodenv-installer/master/bin/nodenv-installer | bash

# Holy fuck I hate the Nodesystem
git clone https://github.com/momo-lab/xxenv-latest.git "$(nodenv root)"/plugins/xxenv-latest
# Fuck everything about node
nodenv latest install

nodenv global $(nodenv versions | tail -n 1)

npm install --global prettier
#+END_SRC
* Snap
#+BEGIN_SRC shell :dir "/sudo::"
snap install signal-desktop
snap install spotify
snap install bitwise
#+END_SRC
* KDE
#+BEGIN_SRC shell
file=RjGYtZL.jpg
pretty_name="susquehanna_park.jpg"
output_file="$HOME/Pictures/$pretty_name"
wget https://i.imgur.com/$file -O $output_file


dbus-send --session --dest=org.kde.plasmashell --type=method_call /PlasmaShell org.kde.PlasmaShell.evaluateScript 'string:
var Desktops = desktops();
for (i=0;i<Desktops.length;i++) {
        d = Desktops[i];
        d.wallpaperPlugin = "org.kde.image";
        d.currentConfigGroup = Array("Wallpaper",
                                    "org.kde.image",
                                    "General");
        d.writeConfig("Image", "file:/$output_file");

        console.log("$output_file");
}'

file=DCIcWc6.jpg
pretty_name="brothers_ruel.jpg"
output_file="$HOME/Pictures/$pretty_name"
wget https://i.imgur.com/$file -O $output_file
#+END_SRC

#+RESULTS:
